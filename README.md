# ruspahy

Short for **Rust Smoothed Particle Hydrodynamics**.

使用Rust语言编写的SPH(光滑粒子流体动力学)模拟原型。该项目目前处于
早期阶段，主要用于实验和学习目的。


## 使用方法

1. 安装 [Rust](https://www.rust-lang.org/) 工具链。
2. 在项目目录下运行 `cargo run --release` 启动模拟。
3. 配置文件位于 `assets/config.toml`，可调整粒子间距、时间步长等参数。
   当配置文件中包含 `[[spheres]]` 条目时，程序将根据给定的中心、
   半径和初速度生成多个球体，可用于模拟颗粒碰撞等场景。
   若同时提供 `[bucket]` 配置，则粒子将被限制在圆柱形桶中，并随盖子下移受到压缩。
   默认配置描述了两个静止的金属球（直径 13 µm 与 20 µm）置于
   直径 30 µm、高度 50 µm 的桶内，盖子持续下降使空间逐渐被金属填满。

生成的 VTK 文件保存在 `output/` 目录，可用 Paraview 等软件查看。

## 项目结构

```
src/            源码实现
assets/         默认配置文件
output/         模拟输出（已在 .gitignore 中排除）
```

主要模块包括 `particle` (粒子与系统定义)、`force` (力计算)、
`integrator` (时间积分)、`output` (结果输出) 以及 `sph_kernel`
 (核心核函数实现)。
新增的 `material` 模块用于描述多种材料及其界面属性，核心计算模块现已使用
`rayon` 进行并行加速。
最近的更新进一步扩展了材料定义，可在配置文件中为弹塑性材料指定屈服应力、
强化模量以及损伤阈值，以便后续实现更复杂的本构行为。
界面定义现在可通过 `bond_strength` 数值来描述连接强度，
从弱到强连续可调，避免仅局限于三种离散类型。
粒子结构新增 `plastic_strain` 与 `damage` 字段，分别记录累积塑性应变
和损伤程度，输出文件中也会给出相应结果。

## 核心算法简介

本项目实现的 SPH 核心流程可概括为四个步骤：

1. **邻域搜索**：利用均匀网格在局部范围内查找相互作用的粒子，避免全对计算的 $O(N^2)$ 复杂度。
2. **物理量计算**：通过核函数估计密度和压力，并综合压力梯度、粘性及界面作用力求得总受力。
3. **时间积分**：采用显式 Euler 方法，根据受力更新粒子的速度和位置。
4. **结果输出**：按照设定间隔将粒子信息写出为 VTK 文件，以便在 Paraview 中可视化。

更详细的公式推导和模块介绍见 `DOCS.md`。

## TODO

- ~~完善材料本构模型的实现~~（已实现损伤与强化模型）
- 提供更易用的配置项和示例
- 增加单元测试，保证核心模块的正确性
- ~~进一步完善文档，介绍核心算法~~（已补充核心算法概述）
